<!DOCTYPE html>
<html lang="en">
<head>
     <title>D Y L I</title>
     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=Edge">
     <meta name="description" content="">
     <meta name="keywords" content="">
     <meta name="author" content="">
     <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
     
     <link rel="stylesheet" href="css/bootstrap.min.css">
     <link rel="stylesheet" href="css/font-awesome.min.css">
     <link rel="stylesheet" href="css/aos.css">
     <link rel="icon" href="images/favicon-32x32.png" type="image/png">
     
     <!-- MAIN CSS -->
     <link rel="stylesheet" href="css/tooplate-gymso-style.css">
</head>
<body data-spy="scroll" data-target="#navbarNav" data-offset="50">

    <!-- MENU BAR -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="white-text" href="index.html">dylieasy</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-lg-auto">
                    <li class="nav-item">
                        <a href="#home" class="nav-link smoothScroll">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="beats.html" class="nav-link smoothScroll">Beats</a>
                    </li>
                    <li class="nav-item">
                        <a href="#class" class="nav-link smoothScroll">KITS</a>
                    </li>
                </ul>
                <ul class="social-icon ml-lg-3">
                    <li><a href="https://www.instagram.com/dyli.easy/" class="fa fa-instagram" target="_blank"></a></li>
                    <li style="position: relative;">
                        <a href="javascript:void(0);" class="fa fa-envelope" onclick="copyEmail()" title="Click to copy email"></a>
                        <span id="copied-text" style="display: none; position: absolute; top: 30px; left: 50%; transform: translateX(-50%); font-size: 12px; color: white; background: black; padding: 3px 3px; border-radius: 4px; white-space: nowrap;">Mail Copied</span>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- HERO Section -->
    <section class="hero d-flex flex-column justify-content-center align-items-center" id="home">
        <div class="bg-overlay"></div>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-md-10 mx-auto col-12">
                    <div class="hero-text mt-5 text-center">
                        <h1 class="welcome-text" data-aos="fade-up" data-aos-delay="500">Welcome to my world</h1>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sign Up Section -->
    <section class="feature" id="feature">
        <div class="container">
            <div class="row">
                <div class="d-flex flex-column justify-content-center ml-lg-auto mr-lg-5 col-lg-5 col-md-6 col-12">
                    <h2 class="mb-3 text-white" data-aos="fade-up">Let's make some fire together!ðŸ”¥</h2>
                    <h6 class="mb-4 text-white" data-aos="fade-up">Want me to hook you up with fresh loops every week?</h6>
                    <p data-aos="fade-up" data-aos-delay="200">Sign up to join the community of producers I work with. Get exclusive loops, collab opportunities, and more!</p>
                    <a href="#" class="btn custom-btn bg-color mt-3" data-aos-delay="100" data-toggle="modal" data-target="#membershipForm">Sign up</a>
                </div>

                <div class="mr-lg-auto mt-3 col-lg-4 col-md-6 col-12">
                    <div class="about-working-hours">
                        <div>
                            <h3 class="mt-4 text-white" id="producers-count" data-aos="fade-up" data-aos-delay="900">Loading producers...</h3>
                            <p class="producers-count" data-aos="fade-up" data-aos-delay="1000">Are getting their hands on free loops</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CLASS SECTION -->
    <section class="class section" id="class">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 col-12 text-center mb-5">
                    <h6>Check out my</h6>
                    <h2 data-aos="fade-up" data-aos-delay="200">High quality loops</h2>
                </div>
                <!-- Your product items here -->
            </div>
        </div>
    </section>

    <!-- CONTACT FORM SECTION -->
    <section class="contact section" id="contact" style="padding-top: 20px; margin-top: 20px; background-color: #171819;">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 col-12 text-center mb-5">
                    <h2 style="color: white;">Any questions? Feel free to ask!</h2>
                    <h6 data-aos="fade-up" data-aos-delay="200" style="color: white;">Send me a message, and I'll get back to you soon!</h6>
                </div>
                <!-- Your contact form here -->
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="site-footer">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-4 col-md-5 text-center">
                    <p class="copyright-text"> dyli.easy</p>
                </div>
                <div class="col-lg-4 col-md-5 text-center">
                    <p>
                        <i class="fa fa-envelope-o mr-1"></i>
                        <a href="mailto:dyli.prod@gmail.com">dyli.prod@gmail.com</a>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- MODAL -->
    <div class="modal fade" id="membershipForm" tabindex="-1" role="dialog" aria-labelledby="membershipFormLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="membershipFormLabel">Sign up</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="membership-form webform" id="signupForm">
                        <input type="text" class="form-control" id="name" name="cf-name" placeholder="Name" required>
                        <input type="email" class="form-control" id="email" name="cf-email" placeholder="Email" required>
                        <input type="text" class="form-control" name="cf-instagram" placeholder="Instagram @ (optional)">
                        <button type="submit" class="form-control" id="submit-button">Submit</button>
                        <div id="form-message" class="mt-3" style="display: none;"></div>
                        <p class="text-muted small mt-3">By sharing your email, you agree to receive updates and exclusive offers from us.</p>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/aos.js"></script>
    <script src="js/smoothscroll.js"></script>
    <script src="js/custom.js"></script>

    <!-- API INTEGRATION SCRIPT -->
    <script>
        // Configuration
        const API_BASE_URL = "https://a2e8hwnp6e.execute-api.eu-north-1.amazonaws.com/prod";
        
        // DOM Elements
        const producersCountElement = document.getElementById('producers-count');
        const signupForm = document.getElementById('signupForm');
        const formMessage = document.getElementById('form-message');
        
        // Helper functions
        function showMessage(message, isError = false) {
            formMessage.style.display = 'block';
            formMessage.textContent = message;
            formMessage.className = isError ? 'alert alert-danger' : 'alert alert-success';
            setTimeout(() => formMessage.style.display = 'none', 5000);
        }

        // Get producer count
        async function getProducersCount() {
    try {
        producersCountElement.innerHTML = 'Loading...'; // Show loading state
        
        const response = await fetch(`${API_BASE_URL}/count`);
        
        console.log('Count API Response:', response); // Debug log
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        console.log('Count API Data:', data); // Debug log
        
        if (typeof data.count === 'number') {
            producersCountElement.innerHTML = `Currently, ${data.count} Producers`;
        } else {
            throw new Error('Invalid count data');
        }
    } catch (error) {
        console.error("Failed to load producer count:", error);
        producersCountElement.innerHTML = 'Currently, many Producers';
        
        // Optional: Retry after 3 seconds
        setTimeout(getProducersCount, 3000);
    }
}

        // Handle form submission
        async function handleSignup(event) {
    event.preventDefault();
    const submitButton = event.target.querySelector('button[type="submit"]');
    const originalText = submitButton.textContent;

    // Get and format form data
    const formData = {
        name: document.getElementById("name").value.trim(),
        email: document.getElementById("email").value.trim(),
        instagram: document.querySelector("input[name='cf-instagram']").value.trim() || "Not provided"
    };

    // Validate
    if (!formData.name || !formData.email) {
        showMessage("Please enter your name and email!", true);
        return;
    }

    try {
        // Show loading state
        submitButton.disabled = true;
        submitButton.textContent = "Signing up...";

        // Send to API with correct headers
        const response = await fetch(`${API_BASE_URL}/register`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Accept": "application/json"
            },
            body: JSON.stringify(formData)
        });

        // Handle response
        if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        
        // Success handling
        showMessage("You're now signed up! Welcome!");
        getProducersCount(); // Refresh count
        signupForm.reset();
        
        // Close modal after 1.5 seconds
        setTimeout(() => {
            $('#membershipForm').modal('hide');
        }, 1500);

    } catch (error) {
        console.error("Submission error:", error);
        showMessage(error.message || "Failed to sign up. Please try again.", true);
    } finally {
        submitButton.disabled = false;
        submitButton.textContent = originalText;
    }
}

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            getProducersCount();
            signupForm.addEventListener('submit', handleSignup);
            
            // Reset form when modal opens
            $('#membershipForm').on('show.bs.modal', () => {
                signupForm.reset();
                formMessage.style.display = 'none';
            });
        });

        // Email copy function
        function copyEmail() {
            navigator.clipboard.writeText("dyli.prod@gmail.com").then(() => {
                const copiedText = document.getElementById("copied-text");
                copiedText.style.display = "block";
                setTimeout(() => copiedText.style.display = "none", 1000);
            });
        }
    </script>
</body>
</html>